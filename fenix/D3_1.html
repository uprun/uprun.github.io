<!DOCTYPE html>
<html lang="en" id="html">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>D3_1</title>
</head>

<script>
    function check_camera_restrictions()
    {
        if (camV > 90) camV = 90;
        if (camV < 0) camV = 0;
    }
    function myFunction(ev)
    {
        console.log(event)
        if (event.key === "ArrowDown") camV += 10;
        if (event.key === "ArrowUp") camV -= 10;
        if (event.key === "ArrowLeft") camH += 10;
        if (event.key === "ArrowRight") camH -= 10;

        check_camera_restrictions();

    }

</script>

<script>
    mouse_is_down = false;
    function my_onmousedown()
    {
        mouse_is_down = true;
        console.log(event)
    }
    function my_onmousemove()
    {
        console.log(event)
        if (mouse_is_down)
        {
            camH -= event.movementX / 10;
            camV += event.movementY / 10;
            check_camera_restrictions();
        }
        
    }
    function my_onmouse_leave()
    {
        mouse_is_down = false;
    }
    function my_on_mouse_out()
    {
        //mouse_is_down = false;
    }
    function my_on_mouse_up()
    {
        mouse_is_down = false;
    }
</script>

  
<body style="background-color: #333333; padding: 0; margin: 0; width: 100vw; height: 100vh;" onkeydown="myFunction()" 
    onmousedown="my_onmousedown()"
    onmousemove="my_onmousemove()"
    onmouseleave="my_onmouse_leave()"
    onmouseout="my_on_mouse_out()"
    onmouseup="my_on_mouse_up()" >
    <canvas id="myCanvas" width="640" height="480" style="border:1px solid black;"></canvas>

    <script>
        
        canvas = document.getElementById("myCanvas");
        ctx = canvas.getContext("2d");

        x0 = 0 
        y0 = 0
        z0 = 0
        x1 = 0
        y1 = 0
        z1 = 0
        monX = 0
        monY = 0
        monX1 = 0
        monY1 = 0
        camH = 0
        camV = 0

        function round(a) 
        {
            return Math.round(a);
        }
        function cos(a)
        {
            return Math.cos(a);
        }
        function sin(a)
        {
            return Math.sin(a);
        }

        function VnV(x0,y0,z0,x1,y1,z1)
        {
            var H = camH*Math.PI/180;
            var c_h = cos(H)
            var s_h = sin(H)
            var V = camV* Math.PI/180;
            var s_v = sin(V)
            var c_v = cos(V)
            monX=round(y0*c_h - x0*s_h);
            monX1=round(y1*c_h - x1*s_h);
            monY=240- (z0*c_v) + ( s_v * ( y0*s_h + x0*c_h ) );
            monY1=240- (z1*c_v)+ (s_v*( y1*s_h + x1*c_h));
            monX=monX+320;
            monX1=monX1+320;

        }

        function L(x0,y0,z0,x1,y1,z1, color)
        {
            VnV(x0,y0,z0,x1,y1,z1);
            draw_line(monX,monY,monX1,monY1, color);

        }

        function draw_line(x1, y1, x2, y2, color = "lightgreen" )
        {
            ctx.beginPath();
            
            ctx.lineWidth = 2;
            ctx.strokeStyle = color;

            // Set a start-point
            ctx.moveTo(x1, y1);
            

            // Set an end-point
            ctx.lineTo(x2, y2);

            // Stroke it (Do the Drawing)
            ctx.stroke();
        }

        function body()
        {
            L(0,0,0,45,0,0, "red");
            L(45, -45,0 , 45, 0, 0, "magenta")
            L(0,-45,0,0,45,0, "green");
            L(0,0,-45,0,0,45, "yellow");
        }

        function clear_screen()
        {
            ctx.clearRect(0, 0, 640, 480);
        }

        function draw()
        {
            
            clear_screen();
            body();
            //repeat
            setTimeout(draw, 10);
        }

        setTimeout(draw, 10);
    
        
        
      </script>
</body>